This is more funcstions and more nested loops
